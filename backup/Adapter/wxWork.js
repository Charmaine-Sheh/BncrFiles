/**
 * @author Merrick
 * @name wxWork
 * @version 1.0.0
 * @description 企业微信适配器
 * @adapter true
 * @public false
 * @disable false
 * @priority 2
 * @Copyright ©2023 Merrick. All rights reserved 
 */

const request = require('util').promisify(require('request'));
const { decrypt } = require('@wecom/crypto');
const xmlParse = require('xml2js').parseString;
const formData = require('form-data');

/** Code Encryption Block[419fd178b7a37c9eae7b7426c4a04203d45e01cd4c8344ffddd8d874f1b64a311beeaad184a72027c29159695061e0e69b62750a2eae197cbfe940e731ee1b9549ccb89a2d30c3c3f528423b1aa2b70722c960c2478cec9cc3d1e3455454f0e1a7fcf1db10e4175111c9012393e73d0bca64474d03b1b3c39c4e77156d071c32422f202fdea9be34275f1f31efb9f3e0b804a2c55f53eb3b0826a5011089d22591dc7e5bde36f7fd17decadc56e45c3def4d2c2c7fc974844150192751a1de71b7707f02de4cd87e85d1ef704b4ecb3f5c25b612cfe44b5d1d44d1d3f92470e3e3518064ec8b3a442b25c68136f3fd4415ae36c17a8dc75f267e263bd7e7260af9d752a578cf9b55ba064e38abff87e04d45495e41f91600b63d740d1a913b1e589adeca27727f66d8ff98b8e34a9524688ebfa6483e4ca8729165fd06e275c1b2eeb11a6963639798ab1b0aebcb203c088121f6b7fb3e57ac2ce1bebfd72f17e067244901e3d139381497259c1def3a7de1c80487a71151c001d24a2b5c9321b8af1e5e4063cad612e276f3c00f18b14b6cb4ea23aae64742e89662aeb249aea4188229390c7a8a48d50429b5113faff20d8b21eeecbe29d647cade794b9441f55d7f6ae05565da7acf9d2faaae6e6d86065930e02f677a4bfe423c62eeb9853f5b9542262b15e69a9d176664d02af50b5a3e4675e783fa135f3da72fae81bfec54ae8e570260adab6060e8dac4b052df70d29608d06d63ce9f38cf34de566385dbdcdf5bf28dd9fb8844dfec78aa8a09724f9309d3228fc519bc8a83fcd63ac26b66697b44b6039413500dd6357859509f4eb370c137e8ba4e779d38e60ebe5d57740f321015a84a3e796a45b12cb764f6ab48c4d0bf9f6e383a0a4dcc80709355d3d545231de149115cb253a86f4b954c9a2c9966b6f14d97ec749a8c43b0ada27a5d0f6239d010f19cb3a33bbca3def3c65a78d40d79c6d47e63cc9328153fbe53a0af9998cdf07a667e5d323cc9c2f116fac16b8d34c66b513e7a7f3d96cf5d60c147629faa8210465f2691922eb58c2b4ac875c274bbe0527508db2c8468069189817c3261d68094abcb07769b6d8f715b793924c4e2b1ba8e45f02a2cdcba48f8f85fa36803a71f679df81f7e21aa610e71484796f0595866691ed82a99a7c4589bfc6865aaedd44f790fc5f1fbb584ab45a344693bf08e7b3527680fb558ccde8c6501ecea6e7298ec97be7db7f1cc163c76113115f7687e18c2be2b8b14175c9fb74c2bc15ecc2fef25ae1840e018296c1491ab85a28dd2e99af184c0891babef36916e06425906eee9c22071d3b5830a45e6dc4de6d1a777985334525bb8e05eab4cc18c48a4f53506eed49e2a6df28fca7ae139bb19b64ff1776add5f7e176ed1baa90de7768963009e69bd2d67973a175521e535f716dc3c64a41e2fd23dc0154580e9dd2113e131b347c8247dee004985348e7a0ee997db079c7c437763993dffeb5a419187ba842d66a5c7d48075291f52bfb263d6c68b86fdac550994255aa0daaceeaead766b763dda53ac5de4a3fca53f072d5e8a166a403b7392e7b03cff22a31d3c004338c0f39edacfe47dbfd5eb4a8b1ea021d55cb0c14df09ad86cddb2230aeb76556fa68f6b0eb97f0a5e185792f9c8e66674977aa0c422dfd008791ce1530b38f79329ef842da93b4e8f2a49d2bad6b96104311b6075d2b7c4115230518f20dd8c531cdd908ddf0dd4d297a336fdf9ba776ee801844f4cedd64a7f8b793970786b1876f3340b183f7a2f5d5c17fad1c063d23935eb675627c3d2fd623f4b262eb308b55a98a73c4d64172748033808713b7f9d88db2344e1270da1e4f92834c326eb6eb9f48f3f607f74e836398a0810ff5b26a9b68fe50ddb31886f69196cae4416c2e2e9071c9c29206f3b34afe5b5038bb3195d127bf0fafff8e4d2753b1509f324c1bd4b49f59dfebe900a1626b4bb6cc180c0abeac678b4a1408705aa10577680909af6bf5708353097da97e78c7430c6760396437e238297cbb4f9e10225aa2f344424fa3eee5d10bd85fa051530a51be9df18bc8dbc802c4eb914db1f7bb73e7c6a7a25cc058a6f82ec0bf0d0cbacea4ecc4ba02bb83fccc970b707430dc33ef2d81e21b8929142133d34bcd1b1646c7b133da629c636024aed146faa9d82adf7aadac53e67691f0cad0fb35c817f5acb9ad12f4b49b103a032ae8ae931653d040fc3c46a557362453fd5dd02877d5880797be4080bf74d3faf3a0b8485a509021abad98395f359e9399164a6214dce47d309743ab6ce6a2ba8b7249c575c24bc94ff7bf241e0f09b57b7bf25b35c7ad4c7aff5e09bdaf5b02eb118d9467d456f634082fcfefb672fdef22c52b243fb2aa7bd583e321c89786b2d8a6da8e89c54ffd117af4e30aff678d5c9843d66c5cb87082e1d921a3f363641d39cd23494b007dc4091a87daf9ad67b9886e8c1a143fdb1d532efdc7763c690967f0aaeb64cd8c2731da62a2995c58a160012ce95a894635bc6e637135087dabcf1b473dad9f8551112f129593e45089082ffc77c7547be3c3addbeb2daf1a3aefb676186d0b40ab82fd559b2af4ef7f23a1d04bcecf33eda367e12b1ecfa3920252c2e43a8e2c93f390728a92f07fc005261d67b5afe5863ce3ea91fed2d70b1c35c5543f61bd8f94a254783d5c65ef63ec6f7f272006f37adde0c374a8f507d02e4673482567bb027543ea32d82d7e4a1dcdce53e144c10eaec100803aa83c67e9bb2a5e672e3761fdb8209e7f72cb807286bda6726a470c312cd7e4f215a6b4e12028a28eedb62591b2289312c79e50a69e1ffe1643b0191683b4959489bdf5b4335669323df601ef2d6b9af502f236cf2a63d957449f19ab8b286681ccfd783f8122aca11abcc771647870b629bfd2f6e304f331403934ce6308357507ca5f78d6edf571bf8db66c5c596ec7497d6ccda0d6b61d4c44990c05a3d65957acb19dc939fafeccb10e9efa7eae1ad609d090413022a901c3de5f43fa007ec110f8ea4447da823a8adde26e73f9f646ff09360d0e116c1dae01ecdd2d6c028bbd4f5ec1120fbbf6f953f02e787c36bb32bbb65b2b6eab60ec1ec8a6bfefa4f811826562c7c0d45bafd86ef312a3069d78746c35018a97fa824d3839fe9db90bfd10d3e8933d311ff25ed0ed3fc2e3d0102c5626e7ac387ba246402190c19c2f5b37beed5da95043aa67c5d10c8d6ddd057541d4084942ec8857c420973fed4061959acb496963cc8381d3aa26a7972a20413a48dd6682e0b9fa9095d8dba1aec735620849c10acab3c77f83e8c88c2254f662049c7f735acc56a2b5f6efdf87d07e5ab4b7990c7f2dca5704045658a5570558cebd3a5bfc05ae2bf516030951eb3377c528b3e3e96cae1622e0337f3f8f95f1236991d11fc6b49f5581eab476d1ee4a968c5d74bc9866595f597c45af911ef41606ac37487fb4e3f4a24ba6b77cc7434bbcfc885d51c71cf796ecb958bba47c24e9b2b05abf4339d12d509d3bace176a94ca4d2281ae4a16ba8b5399fc7e1e36c83bf0d7a30780f97758f3fb6e6f72dee60351c5a86ea9c6387be5a375ef941daf407b678718d8877f5abe3bf26c58b1c7ae59ba313f02cbbd0a18d1bcec2c73838b2e37c3f6e5da6072ec238208093872519aac41ab983c746741ff1383935a90ac4ddefa6cadb6878de5aa9675300f902cb8939e5bb2b58893c8b937423d438b426ae00d04d3e4c76ccbe6b3d62a5f35d94853217273478d6cadb26026fa8ffc88c47f48054f714270849270d13f1d7e0e70370c1e88aba863586f6a47a01aa5780dd9c0cc9b62a5b1100a79da77260855bb780ddecf0955c23336d4884057a75d8b4fbd79c34986bc3d68aa0f7ae1805d54b6d6f48c03005c97c863a231e69df5109dc4794778d3c7fb4fee8c90c433cf889471dc636f972b87c073827324cae8200fcad87412fd76ee61832f781285dfe7f341565ecf8507a564621cb1f2b8ac054f802a175ef445357b829c93a9890292a644da4a37490811eae6adf3bd5848b2d9ca50be29ee699a625162b90d5a8171d53e8bdde79d2eed2478a7e7e087427a07b3c04bec2a96f0bfbfd225ce2ca42d55538010010f3a8575ae4091741ea1c41ff38b0e6316336d49821ca12b04e7f18f83b3de6a902a2c5e5923c8a0c2c018eae9147cd5c47b8120b09f54491478b3aff0d02622184ed72bbe0e6c100a87d150fab52199f79080f2f92bda782feafcc8a4f91f34f69e97a384a4a66406cc3723003c79cc9a72ac2fdc3e864182c4f2bead0858d3d271359925f8e0e2dc4c7f86f3c5439ebd2211d3080562ebb9764a55b5e536581705d6f2a11cfdc9e64f4e64f6266a85b4cb4d2d2c70fb2db6a6e5487fbb82a44c23c3e2b5405cf8163b73b081cb5168975fea4b895071df717c5b59f4d0e3a75c9920b6f7c501c7aee576a88470ebfb4550b37a9c61ee2f3cdc3656cad835df4fcdbedfdf2c0c96b0c93a93b65d626ad79bf9146a26af37464258d1135256312ab84e94fd56cf7c33fa128185a804d7d735fad134f0642e984e4b442f196b5fe13536932f872a65541bd2753a63eb24c2533615699d084106641e82fa834a1936afaac56c264ad7982b1b249ae7d63977cff5f2a694a610ef3e887ea627cf01fc3cf81b7fc08e09c0ca3b29605db9d3a2bd05c569b6a8a0b6c80ad4344ec670d4980a5e742fb1c8b3181e24c662db830ee9ead6cef0c02b4f6055550fb1181ce59d0ddf4e51a5967fe562df972aeba74969650528167419323f2c83375e342d206336163a93b4f4da37f8b1c25b897444fcc68f2256b8bb92f7f5610a6c5f1ba7e5a7649e8c94864c1865ffae277ddd9a0389cb2e8f2854792ea27480df31b7299497e18addc0c4157cfcac967f2c39351ccec0c2d9c31be50713710263d89aa068dabfe67ac8ab174876977997f89aca61f2efa61998687897217c74a24b132c1b1fff01aa14be849081e6129911fa6ba074dbab9827a05d2d774e846939b5932d487453049fa43e5ffa88fe794858cc8ec9834f08e966c5e3233208e450770a1bcd7b09b479971a5186f2a31c271234f9df8e0ea255125df4a809cc75ed79a33bb6d2f5668490928b1487ddf8f780cabbcb270f14e9c62f83d16fac757eef98ad9e509c9928cddab2f0e3b63beceecacd545edc13c34906267c9e5d22650edae2668471aa2d73b118b8e56f9e8691b8b3664404bf5b669ccf24cdb29181aa69040d8901736337777c96afcf76520f7d0bdf4e9c2993673b2b99a788dce5712f89bc312030f9b2bc79c80dfe05fcb3b0319720bdf02735d94289b0de3d2b829430c04bd4aaf1b5b86f73504dfd06ca03c3efb208424e107c3438b86c7f98d1b4c8bcc67c29644894b22ae50f20d63d5c7ea4330190b98b6dc972c426671be199259da01653c1fe378ba11f1559f374d6cf923395d1bdc5d451884dc8f0182940888b375bef28c2d333c6c1e259abbcaf29bfa7807780376bfc727fbb998b8226a56d057871feadb63f0463167d1961d887007f7d6f7e0ee25738b7c0908846e45208d5a7ace22878cfbd8000dc9bdfa3fd820c2c7d495081d61659b968f893b17901934f829b9ca00395d4e0efb167ea9eb5b10c65d573dca17907e4f1b7c1e35953ab15622cfc884cecf9fe671bf0af31fb32b6170e6576b6eeb5e95d536145e70d116c453ed5892baaa43b5f2669a0a97722e960d08f7c6c0b3b21cbec9c7966533e9582aa71c0da387a16beda4d4b6e6ba11d49dcaa2220a27500943a9d5d1d7cc04ae452d572fb5e52db35f5b3a9120296250eb24e0c52b2e2e53778117647b3303d9b1a00950f763a65be12fad473cd13ff9c21e1dfee0b66f2b4ed4b7cb6ed6921e1f82ec03fcac03001775b9ac50772e85a2916a3388f575063b2cda3c6e8eb9df3e706e58433fac8bc1c4bbb9f11f13432eab55926a134235f0309fd77c31af47ebcff26c1f169d58cea56a2109c4f752fb285712d28c8ba0cbada203216e0e31eaf0e0146cd78c59c1959b39a628dde5f7c68e8e851bee93b9fc275a2650700aeaa4b037fd67e6dffd648ec086145cdd03c6a29375155bd2d66b5ae44c2c75b6c3d29c4be5ee9d6dd33c1152497920da50ebeff2b5974d8bc28d9de882609769d46ee85349810a1b2ce06c36ad67eed1109c158c3ff6f9392515ab9d5a5a0e4a5c916062136c45ebe80f9a5538a7ea0e12b914ade579934113d37b1245ad6298739c73ad4ef3d823df252c262852b08796feeea1104e5bbdf1e6232cf4c6df72c0e9dd47ea54db6d5326151b9a974b2b80ba7598f42fca8b8f7e2edeae1fce3d1d96c2c7546411f607b17be16493a4c490f9d4669e421be32301a43b0114394f74d3bd256787cb9732cd773d4504f4ecdd015f382e26a48eedda2d77064f8ad701d476f6e3aa17bd24cb9993bc8dd97e97cf36618439842b05de0f7aded9af1e9a69ef4d0eb73544e4ef725abfa1447e67c9213ef8e996a8d2334acccc32d9825931bb7aa7881d91d479a57a0158cf2ef2e0f4fedcee09da533dda3a7d0b614f8175088c84e74f4016b8f518e5c0cbda832ecf0b3349bf9d83f3ade03a375486f0c3c2276bd462d8fa7b9d06072b6ba8db2bd29f5340cbd2efcf8d92b524a9206850a8a4204aa2b5aa0be61157bdd3f45909e5de927ecad7370c1763d296d2f286c3900c4207d9474253c325e988433750cae7c33a82ffd7952b570b559951eacc46a37c341f60d41b994e24e683b21acf0790be1262bd29daac50fc2c48212ef6232d1fb4a07a36d5e736c430d7d6fadd84d6b55b33937363c38c6ab53e22d061349c2954dc1b2b231251cd8a11739816684472e4a5e20ba28998f85b5ebb1f94c3d8a0b19c52bca51edcc6063247b98ac7359b6ad02d38f2720a966bc3665e3f9f42509cf55e94e55d7f65aba0d1056bf51672423d0411f0adfd111b1a452295964a99c20a5b121ba39f126320b11fe0f98b2718585df8b821c1458443bca3c17caaa98f939cfe6d2ef1d193f450007e970633762c88c80acef9927d9a1ea180a77f4eeebeeee9863a169fa0931dbbe7e0c859c65dc9be1dad06c7fb63c99c0825f9cdd2ed784b4e5634daad45bdeac47cefe2832912b8a3ee227849df8ad2a957196535a69c6cfe1359a3d381a20c4d351b0e074a96d897a274d0d10e13589f80d544b95077c19a57e417c929938dd616a1024fcaec96ab7c5218a62a84965a53a0867d3f4165cde9c76efaafe284f92489e4707a4de345314f0414f1040355eddb2de9c828bba64c51f044f554a29dbbae25f5c9a45ef998d21ad38e42559587d58d29bf8837468661b89e81eb38492362b6fba8dc2e97230cdad1473956bde0f39fcd1ee8607f559c8ab374dd87b163671f0c069669e8b0d3145e10ebfdc88c41071c281f19172e385d5c5f7851608bd5b0f0028d533d722ea32fdae91dad310372c725a29ac797bca4f16f979a0403ac8ecefeb9a6b30f6eabd56ce6a70ba7828092d1e258bc61aa22eae19ec062b266ed4b5415d3e7695a2f912f686ab33b147a8d84e44c1d07b478e874cb1f693e65b07146ddd82b73b0cc982623d873a5e35062e5a6f945e20c287d167364d5a74e8b8a87f60fabdffb6e4d8ad153b7c9e661866242933c128bbf1cb44cd5f1ab3e6681c48136ebb6c6868b08902ac3140b976eadfdd13d7d1a0c40a906e567aee2bb696514d72c11129f4d269b0a0ed4b35423d37ed570cd33469825f9c4f9882f1219229e5893842c51d588c73523b6ae5db0cccd0bb705a02eaa48e3c0d1d69a957360b9725a6c1c57a561f3c062d552d25c8c8aead933c638154a79d1762b45f7c850003eae65b31ae66094f86c35884e3d088c73c783216458b8f6457705fdb9d73d466c229ca783fe77261db13e77e0c11ce573d895290e3021491c43e82f7985897e1b05899fb895287b11efa8c429a905c75005debcd5dfd1fa90df27d2d96ef1834c0014468d73236bd39c20692c006c00993f32fa08fafc70c70c2825a407e17519be638e99095e304f12bd7cd012dcbf36ac7a920e12fec604ceb6b45d5d4fa314e6e0b65c579165d9f77b9868d254ff8b17f62d30408ca65dbab870dac7cba241c4e09552ffc96ae33d76f5cc15ac407e70645204c762c019949bd48eed79e3d4c2162bc2a14107c09fd5a3f87afc89f3faffd497c646e3ed1ed8c71caf2a7b377984e3800ce42228b84ebff9e3ed35fa935c9d94fb8a67e512de943216d8cec3b4aa6ac301bcf99172b3fed485f62827dcbc3f3e432da36efa9439e533b02ea4f51fcff07f9873bb2a629345c6b982447dafd3125c7272b356776200dc7c8ce6d51d5718fc68e6644fa579a0fbd415df5bdd85c7151dcb11652992892a63780f683cd29eff41e987463ae5dfb768a088da477099efbd01d79c6577df9acaf54527c96c2375fbae9964330bd3e528a0c32847a99265f4df054ca26077480e43a8ab457f509e510ec55ee651d2337f507d51bf852cfdb9d93886280d45817848039ee0c37a20cd4401b2037ee126b88625ace14bf855eca812ecf1ccdddd63ace67cd46676801d3b867e531a1be3a32956abafe7a976e578e35d337da2ffd6181fcaa0cc542dff73db120ae2b66988ee7690c85a3d6c99da05f2f7fcde36f8201d6d30dc00f63b9299d3af03656056320509f36b3854d79dea9157ef290aaeaeb64f2cb0d9cdb7e84761760d52e87b4cfab9244ff417a5563c3c20b04d32338b461339e4c166bcf18087c6cb6f186c5de3e34374d1a2b6d1999ec6fb0dda2e0bec8f153fc7a9fede4360b9dfbc1427e0478e6124c454d2715c052cb6c7ad82c1e2eafddaebcca1b3863c8106d9d42a12a8427d6aaa014db59cf6e201ef570a345a7640a6f2f45cdda4e55f7ff461fefb6fbe1b83a7edb7bb931ebb7d23b079fe9c00646f1604a5a43229b40219709a7904b81b726537c33bdb8662053d6a644b3bb7a87a145c31c8f3a3ef470be505051e1d886c9e40ba78407ef29425fb2ddf39f862edf0541befc7ff4b58314a4b9bc119abf672fb18b36b6d355dff2df8c5a93e2eda37dd6ae67e01956ce89cf316c5c908e0ec8bd96818be1b3121e1c75e5e02cc6a5bb1c0e7146685f2ec530d0af2d005e34094103ab8b3a432d5cea861f774286310429b440ac100964133395e5c1b5bd758f93be40b6ef9287e233334c26f8e07c0d0e4b3bd1e71fd319eb2a58e8c0282a34e0128f1928b9439f4357e74d59086a74a89c9eed6a34b1bad29ae73a369fe51e7328d3816f410fb277517b4cc4194b6ce2d9d22a2ddf8c20c8e56a2d27c5d345be69ae517419603f520b212b4d906e30fa8bd1cd4ddd1b9656fdce8e2ab69d453e713c3fa66b89fff08a9d74c8f0d06fb26e3cbbe15fe29c6435005fb449177db73ab2e61b059143d1a5ef45c9027d6678455845dbc89a274a68e251fb87b34f9c30a0bacb7736d9bbf16e3d119108c0cc24a6d0e109bbc71ecbf88ff614141c4cc4eb27c17f8718345dd5e00f3480d036ebe9c0d2712c4ed6aa7fac6e937bf83a61f72ddd5be2890df33fe5447316710788d9c178b9e6a9dacdded87745a84f469eb63f21fc0a5e9ec5cb1cc2eb1e84968301fe32800ed2c72b1b2dbf435ad4a4456a8481b1c8859a08dafd66c77d167f1ea5e11c99673ad012aeaec45b9859936b20da8da06d27fd2c61c1c97bf133c5168d2ca89d30a3178b26b1633d8eba40f02a50ab0a9f1fd83ea36e09d36568363d87d77d72bc4c889f6448d65e64651aef56ff546ab3285c1b5e4b563e6a41406f1bf65656517848aa858d8b6852c893e5661fcccc15edac5fc40dc45f0db222bbbc77accbc6a1ecab953c79a96c85b4b5a728ead1d3538efde225fc51bb776c1b5e380db3af1f905027b294a0ea4d49df100031603dffbfe7c2e6ba8072832967988354969b4e00c612ef8976f6a9fb5b198e5ec8b8037d460b0c276a8bcf33852e3e5e39efac90440d111fb78e730469fd01d3c453297af657ae0d6dd1237d94a3074c988b54831a7da88d9d602a7fd9d4bbeaf274120b652b02eb873b5a04dc9204b933a941d0b21bd74c5ef51efdc0d3d99d9f38734eafad4936e4323ebaad789f60383164ae93c247c346358507fb74e5d4b156a4bd4064a7dd6aaf0ed26cf7f1e76701f847] */
