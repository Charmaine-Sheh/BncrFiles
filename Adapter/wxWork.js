/**
 * @author Merrick
 * @name wxWork
 * @version 1.0.0
 * @description 企业微信适配器
 * @adapter true
 * @public false
 * @disable false
 * @priority 2
 * @Copyright ©2023 Merrick. All rights reserved
 */

const request = require('util').promisify(require('request'));
const { decrypt } = require('@wecom/crypto');
const xmlParse = require('xml2js').parseString;
const formData = require('form-data');

/** Code Encryption Block[419fd178b7a37c9eae7b7426c4a04203d45e01cd4c8344ffddd8d874f1b64a311beeaad184a72027c29159695061e0e69b62750a2eae197cbfe940e731ee1b9549ccb89a2d30c3c3f528423b1aa2b70722c960c2478cec9cc3d1e3455454f0e1a7fcf1db10e4175111c9012393e73d0bca64474d03b1b3c39c4e77156d071c32422f202fdea9be34275f1f31efb9f3e0b804a2c55f53eb3b0826a5011089d22591dc7e5bde36f7fd17decadc56e45c3def4d2c2c7fc974844150192751a1de71b7707f02de4cd87e85d1ef704b4ecb3f5c25b612cfe44b5d1d44d1d3f92470e3e3518064ec8b3a442b25c68136f3fd4415ae36c17a8dc75f267e263bd7e7260af9d752a578cf9b55ba064e38abff87e04d45495e41f91600b63d740d1a913b1e589adeca27727f66d8ff98b8e34a9524688ebfa6483e4ca8729165fd06e275c1b2eeb11a6963639798ab1b0aebcb203c088121f6b7fb3e57ac2ce1bebfd72f17e067244901e3d139381497259c1def3a7de1c80487a71151c001d24a2b5c9321b8af1e5e4063cad612e276f3c00f18b14b6cb4ea23aae64742e89662aeb249aea4188229390c7a8a48d50429b5113faff20d8b21eeecbe29d647cade794b9441f55d7f6ae05565da7acf9d2faaae6e6d86065930e02f677a4bfe423c62eeb9853f5b9542262b15e69a9d176664d02af50b5a3e4675e783fa135f3da72fae81bfec54ae8e570260adab6060e8dac4b052df70d29608d06d63ce9f38cf34de566385dbdcdf5bf28dd9fb8844dfec78aa8a09724f9309d3228fc519bc8a83fcd63ac26b66697b44b6039413500dd6357859509f4eb370c137e8ba4e779d38e60ebe5d57740f321015a84a3e796a45b12cb764f6ab48c4d0bf9f6e383a0a4dcc80709355d3d545231de149115cb253a86f4b954c9a2c9966b6f14d97ec749a8c43b0ada27a5d0f6239d010f19cb3a33bbca3def3c65a78d40d79c6d47e63cc9328153fbe53a0af9998cdf07a667e5d323cc9c2f116fac16b8d34c66b513e7a7f3d96cf5d60c147629faa8210465f2691922eb58c2b4ac875c274bbe0527508db2c8468069189817c3261d68094abcb07769b6d8f715b793924c4e2b1ba8e45f02a2cdcba48f8f85fa36803a71f679df81f7e21aa610e71484796f0595866691ed82a99a7c4589bfc6865aaedd44f790fc5f1fbb584ab45a344693bf08e7b3527680fb558ccde8c6501ecea6e7298ec97be7db7f1cc163c76113115f7687e18c2be2b8b14175c9fb74c2bc15ecc2fef25ae1840e018296c1491ab85a28dd2e99af184c0891babef36916e06425906eee9c22071d3b5830a45e6dc4de6d1a777985334525bb8e05eab4cc18c48a4f53506eed49e2a6df28fca7ae139bb19b64ff1776add5f7e176ed1baa90de7768963009e69bd2d67973a175521e535f716dc3c64a41e2fd23dc0154580e9dd2113e131b347c8247dee004985348e7a0ee997db079c7c437763993dffeb5a419187ba842d66a5c7d48075291f52bfb263d6c68b86fdac550994255aa0daaceeaead766b763dda53ac5de4a3fca53f072d5e8a166a403b7392e7b03cff22a31d3c004338c0f39edacfe47dbfd5eb4a8b1ea021d55cb0c14df09ad86cddb2230aeb76556fa68f6b0eb97f0a5e185792f9c8e66674977aa0c422dfd008791ce1530b38f79329ef842da93b4e8f2a49d2bad6b96104311b6075d2b7c4115230518f20dd8c531cdd908ddf0dd4d297a336fdf9ba776ee801844f4cedd64a7f8b793970786b1876f3340b183f7a2f5d5c17fad1c063d23935eb675627c3d2fd623f4b262eb308b55a98a73c4d64172748033808713b7f9d88db2344e1270da1e4f92834c326eb6eb9f48f3f607f74e836398a0810ff5b26a9b68fe50ddb31886f69196cae4416c2e2e9071c9c29206f3b34afe5b5038bb3195d127bf0fafff8e4d2753b1509f324c1bd4b49f59dfebe900a1626b4bb6cc180c0abeac678b4a1408705aa10577680909af6bf5708353097da97e78c7430c6760396437e238297cbb4f9e10225aa2f344424fa3eee5d10bd85fa051530a51be9df18bc8dbc802c4eb914db1f7bb73e7c6a7a25cc058a6f82ec0bf0d0cbacea4ecc4ba02bb83fccc970b707430dc33ef2d81e21b8929142133d34bcd1b1646c7b133da629c636024aed146faa9d82adf7aadac53e67691f0cad0fb35c817f5acb9ad12f4b49b103a032ae8ae931653d040fc3c46a557362453fd5dd02877d5880797be4080bf74d3faf3a0b8485a509021abad98395f359e9399164a6214dce47d309743ab6ce6a2ba8b7249c575c24bc94ff7bf241e0f09b57b7bf25b35c7ad4c7aff5e09bdaf5b02eb118d9467d456f634082fcfefb672fdef22c52b243fb2aa7bd583e321c89786b2d8a6da8e89c54ffd117af4e30aff678d5c9843d66c5cb87082e1d921a3f363641d39cd23494b007dc4091a87daf9ad67b9886e8c1a143fdb1d532efdc7763c690967f0aaeb64cd8c2731da62a2995c58a160012ce95a894635bc6e637135087dabcf1b473dad9f8551112f129593e45089082ffc77c7547be3c3addbeb2daf1a3aefb676186d0b40ab82fd559b2af4ef7f23a1d04bcecf33eda367e12b1ecfa3920252c2e43a8e2c93f390728a92f07fc005261d67b5afe5863ce3ea91fed2d70b1c35c5543f61bd8f94a254783d5c65ef63ec6f7f272006f37adde0c374a8f507d02e4673482567bb027543ea32d82d7e4a1dcdce53e144c10eaec100803aa83c67e9bb2a5e672e3761fdb8209e7f72cb807286bda6726a470c312cd7e4f215a6b4e12028a28eedb62591b2289312c79e50a69e1ffe1643b0191683b4959489bdf5b4335669323df601ef2d6b9af502f236cf2a63d957449f19ab8b286681ccfd783f8122aca11abcc771647870b629bfd2f6e304f331403934ce6308357507ca5f78d6edf57ffb93c3d40419dd9cf60aca631a87d8448592bc06a7575898873882fe8f59e6e8a0935ef0bff1b5d67f64dd48011c9ef2c8f59a76df6b30823b7d4f0ad55e43d9b76b36691fea7f95dde6d5cfd238bd657b911fa8d3051541124a909849b114f9397fb871570c8903871af3636d693190551b537e8940e52f3fc8989976c09d5ad60f08cf12388b4ad333e1092e557f04eed5b6e0d094ae194b06ccc9fb55575d1c396146de5943cf16770cc5f603f1371e4682d87d506f89bdf14e85363cde2739c95d2f7ee229d528b819745a3086dd929ddf3d75a0a8fa922047803b311d63f236ccc911987e783fc8f2cb1d41aeae41e11f674562f9a59f9dd1df196b6a2c94317a9119bf6293dffb0d415fcebeee3a3de48198f36adc0648584d6ddecfc29a3c63bd0c57f105e240656250cdb11f164b703f84a7e9e39152257377779162294661f4e249f33fd41febc8e3efc3109cbdc0f0c830fb9d374687814681cf97b01465ffc23faf52a30e13a6545603977071259353e669a6780161f89912f752b157752d1155fe3ab7aa2fd8031587103a92bb6776787e30c978a001087c2437878354b26a8d0c0260f4ce9d70c4819fbf68edb63a6f1eac2b8f2f7b50d2105ce9098cefdf5ed70a45154ddea4b2afe3d50051d77cf1281082ef0c07fb6b402f493cbf5255644eb3760cef033be7c35803969872aa4bd5a86d516f57df1e1808a06d1d7877b01c124a5622fd5785cc918dda205fc0fbc169ee64074f1d5333671751ddf3fd20d4a7f6253700b41c9646ca1d048626623f98146ff81e96420b6c1523690900e27ab12d7ace613f0b2460ef91a54d1a474e8cffb1d676b3fa18f6f7cd87c965f29510ca041a9e8fad47ce5a0d36082307c36c14175032701d3ed90d27705a3671e43916be57b778a56970186e49fcf27f0a316bda40fd3dc56b03310124955c5b0759a79f599e1c2440dfea10987b99f9371a74fb75ffdbc4e744d3da6e9cdd0eb8fa21729c2e6ad6492017b70f55c3289a2f894e422fbb8c1f649802cf7a0cc8eaa15c08cdfe7689e27a7df1d7095bd8d3a2791948c53fac545a62345b0059ff9be50ddeb4fc9d385aca0dd6088b68ec836f29a5e0beed55cc5c1e07f093da673fb1fc31ed4341be1325016b0302876bbf8f679bc42c549a0d8fae9515d4d925fd08cef466d6339ba0eb6e944bdd78a745ca8b3d8b8caf791f364af7f69fdc9cc141457a4ae49ab2735932af616a5afd6f1e3087996e3bd155a67cb9c490a4531b46df0656dc23c286651a19030f8d1b7207f20af60dae0ad90810376eefaabc43e4d47d10765f541e2fe567d088ec3a468a1de304abf6f31907483bc2f2dbc2be10938bfeae24f304228a36aa30d2409d41c1104e17cfa2b30a1c8d418f57efbdf260308ed01bbf2205bcf7ab4acab77d94976a8ff0ee59661c0993c2b85225cd507292d81863d58e15c650453b7c10e545becac57288a2c60bc7772420685232c885ce78c5633a5ea55bdd4d07152ffc7653abe642e83c56b55f44c05a578ba4d9f5782ed349425a0c5010e83d4c950b19bd1734ebfcc1be09286fd8f64293520ac484f3662b6533ac04d0d4937f2afc8340060f7be0cb63e140b6f21b12539d755ecabadf6c5fb9ce2cbe758869c9d27f6be50edb937b4d46b60807209684452c36e008df3f206bec51b52fe64797b225cc5156e413fe518edd8f3be5193b4678c5bb36255c157d736c6aa1146da026f0014574169537c52851838c4c61d76e8f086324dbf7512d6cde8ec3a2cef0a6f85e100c4d49be55b6f0a9a6ddc6170443c96c8a292497b62d8c14da2f23b31926889dd9fd865569f9647d70199fac39b6a7d0d5eae90b1cb808d3195d16289d355a09e145d00b7d7ba260a863f77c45e7647e714be4f010d9cb53650c8daacb20bae973010cdbb166ddf7907d00c2a4b6480396dbce468cb32102fdc476c32ea350cceacdaedc74531cb82f602a67c0e4e68b039f1638d38c7e8b02b944b7af7eaa7ba0b6a1f909ea2f5da31fac4862bfbf247117e5ea7b06a6d255e3290bec75e2e0ca5ec8a88e0e998afbcd161d4ab72d1090b868b6dc12530c3d6cfec92d9abbbde52bb0e09493115236202b80deb379f3255008f884b2facba09379b3eb8959bb761b9655b666e41cd887dfc85fb64242aa836bf98ea227ed5012ccb3c089327f89f65811edec601779e8f43f519c8506761eefa2e56b1942af3860f1d0ad1a2b63fc99c9aa1ec7ffa54b5a509406a65ac1418a3451ad89f9fa6c0746d5e3fc457516d6ea2353ce4e9a8692f5d3c3b73199993d01e800c9cabd21ac233a190c77ab81a7459b0d54a2921a00d3467981d51a9b3d3d68525174f368bf23a14f036535e061e633105e5cde61c8c9f3c2368acc569ec691d430b7a2cb7340f6e844a59e2f0d1e914b2d6a0bb19a30b34b66010c2c7953d54c2e392139eb6a2e25b52e47c591df69498525a901b9c5f9f5f336ee5ca4601aabe0322475a79034374b967c690d48469a52d04a4036938fee5d7a2ec504a5dfa7258597fa90e55178cd3f4cc14ce253b7afad3843defa21b0725f37941056494ec89243d580a9d70ebecffbd406e8a526e2f6eff32aef00661c5068d26c33f874e69b8c91b37f6b1dd889057360eadd543f4cb03021e1bb7863aa34191c868a8c9b1d93a31e9ebb735045c4ae027e3f6573a021446ec008b74033559410ccf300a6e7bfdb0ceec999de7b35fe378424df4eb65a17dd6132a798193724ed8e2bc84d4833152185dd10761cf46da0274ec2a9fff4decc806262585c3ac3e255638f38696407706a3a5a43150a139120fdac931ca98766d6ee03a69fdaf350a0d7d8bc65239c35f1daa4d83536b71ea4b8831b51c4cd826cf42fc1c742de931dc4b0744f023020a88cd6decd52184dce3166c933e4427b3bbf4eecef815ca9ca375223bb26574b8aa5472f2e2778622e8d08ab0f0d879087ae481aac22cf0e913c1737097f844e3821c232ddf6ca2b8e7698a41ccdeb9982441a0ea0a3178b0c6ea9edf5ce903c7092cd58f82278829921bd53fb116be2ada2d443d6575005265e414dc0e4803d72e1d94edf47d033133cdb584fb8a5a23af77a05b303036a60c752ff00efac30c886a154b811ca4559c6fc5512c8424a6d359fc5361ae0a1ec6bbef2cb52819213d833659b716310497ed189f2c0f50795e7f07d52bb343017d6d1173c3afea65e77b263edc03647fc30a0843f1d60edfa4766f695a8ce5b415baf649108c9928de1bf5e209730920ce6bb91178e127a1f5b61e3bdc76dfd64fcf9b5e6911f2424ace2642bef58627088cb60a941e1b507ba08128848103efb5681921386ffd64560bf37d8c8317de50ed016885cd8cf6825ab20a6e5913302335d2bc3e6746d4e075e188de4db534304d8cc2b4e896f84c9aaf60100a4f88622e291c1faee65f573cb390d3aa7f8f9d83450e8d13133def60d2bfa8f715965f715c142a5192b003e160234eec328502ab996ce2f9e5056894ae0e3768a06eab9e26f50ec14692be03e92e8fc882399405ea063d06e077fb63f0abf46688d50841fe7d7816b712931e35558aa7df5838207cca4102a01e58fe00434a3a9d7d7758f9d07c7d54f7f183e07d7cc2a9984182a1d0d57f099e2073131690cddb6b9504df65acac3e90a9f40050e9ed03cf101665b70343b0207e1d1a38f6c4df06ebec7c060cc9b666024012cbe01c0f22facefc6d6a15caf8dc2402b85223d19196ec65a530c2281d79b0a41ad228b4dc7229e6eb0cab21b1455b7d2cf6e425b44851bb6530549bc5297c75a9c27ac1a06158afe82cce2d353e513f341b1a09d37cd00f2e8c38f5d81e3494645ed5c825a8298e60b7bb04aad0feacb0b4a785529b83ecc5b2a2e369c3c0785a105c930a4664f30c4fe6c1af2efc80e9f9f720af9921a19199a0e147fd68cfd4542a08b4ef962ae9ac10c3e21a52ac01404ab7bbf2da8bb5915c055b56a009b311450c308db9baea3877d9938650dbaf1ecde1379f321e6a65312348645b011166a92e2c27bd4785c2624ae1a43e8a55ecc24a2134807cb4de60562d3a2918e5a59f80b60bd86019e525d4ea28252841497f83b3b4778327b527266941b449ccea68b9beae2bdd51401a9624d8ab8a110e94b5aeb6b5f74741000cc2642ca1dd2c5514ee3feb8320434455f6f91532d290cf90b504829e8abf822e422b6ca9ea1a8eae555f5bea79ad5c7637124c37ac1a69082e70cfe6a6f35747fb84f030744819d7d36a215c94141062872e853f764ee7b0d8c63a90caaad58d3558c332e8c68faf8a3e8bbda3ec590c487f63e76a72b9b2cf45aa6c27d7e02da342f83787d7a5d449959f2b71c844523deeb1f7a1f36a65c134051aa80deda14d886b8e59dcb111282abb1d93c84260efd67a604214366e7c845c0fa09f23a9067d2a0e04dda6d8f316782779def1640c14bfb3bce81f919e43078ee0454f7ed14b793dc55a3e3c0f7b6478f8cc2c8a21683e82c3e018c138a7d6eebfdcaad5ef2bd52236b278fe8bb16998587395e771ae363c0bc9ff0a78a1350e57c7efdfff616673539198c20c8de85c78768aadc433e9344a6afde04285afe81199bf9f574bb37343e7ca209a8414bc1539ed23c158b12b96f08d66515abc92cb9d3c9c310ab5142e75dac7dc21cb3e7c731ef20277bddc6aa998953e1017ac5cc72112046eba76db142463b8253acea4d294c5bc90d564983953137c384448c895485b9d254fc2a07e6764e369a231059eed9dc265c77410bc26e54a155c09aba3c2998cb7f3f66eb3b0dc21dc7efc95dd8cf0b89c5e4f075099fb5ef28691fa34a31f90f4de46647dbd645d675365f167432ee2ecd0f209488e72c7c32c875b7d66bd54c4c3aece690b9ea4158ec366e1c5df3c43bf29882f4b3af1d569a8d674fbf11755dc4e215800cf89ac5c433707c75f13e84051f7d8bf61c798450c819671d5e3fd041d6fbad643590b52975c1180f58c954b824f63291c379c84ea139f034f8e8914173d9b3989b22c193675eeed25b3e4469e702c401584c9283feee3c31dde9e9b65a0347e8103f9af45073a258034821b981bb75d829d6fb5f8f1d8f98ca2af0064ef917d28653c8257fcc32a6303e85675e64abc68ba306252db686ac3d76622766c199b9893be315440382f822021ebf3385ce3842b6464b8a162fd00d5512ea5e63fa862b7f9754ec2e3017fcdb39e8e51bc3fc52ab77d10c0e11f179135cee32641cb979087953fc5716e1edc64132230d47e3d3c1474599d6e41227381703ddf068d02d279784e9f84e5d29f0c81415518f69323a280c6c50de526484c53ccc6143195100bc296aa5d5d7113dc0afede6db4526e167a9d9cca79902af46a64ef9cbc3ce57b6eda8c846b08bf56d7f4f6d24f2441d3ecdbec6f5f13dad74780f9aee6d0e0cf971f08c9abfa5d47e68e1fff22d744f42f0018890695fc717588ef765ce257463facc7703cee7fd8f9c44524d5f73f2f10d8dd9285a78d850c8ae704e9db38937a76e277760d29e2952fdbf5a895ad50b66485f8e90b4ec903c0a38d6524cfdcdbe6f02414bfa45cb9b6e8b1f75fee5ca2f526fd8d8ea0ae0b73c333b743d4bf1a6c8d08e2028facf77254dfe2cba877d43da78023e02a5364ec4655326f64ac7462fc6205f53b19b6620096ab2a1374d916a904df145f6a87b47532cad9394a4696b8636623e016bbfd1e92b880de944f9314128502d19d34e41fe28de807f54dbc6b5caf3a360a818a0ff9634322d0fc40e3180e736ea6a59c3cb21aa34ab4d7d3b079a34f5e4c30e48cba32815221fdd14700ba802a48044e9c364175e7f80710cf39a97aceeb5135acbdd258463864ba2e8a43b7351a04fc49cfeb252c68ec145dd20d2e32dbc3f3ad4c2862bcc40f14e41dcd9d15fa1842e6342c170b21e7d4f180841cfd0e9bbc62be6b198c57d4fa05c5d5456b9d965c6fd7a6c650303f573d83f2218491bc7f78f6c7526ed0fb538920eb8285be05e8b607f616b291a6fc94995f55c228fb47f73763a09ab3152c7dc6f75d72f31eb97fbe814278480d864d6aee1a15e09994c54f35d859c4af2aacdee9e6df744bb71c855693bc8a122bb3e7d601acc69fb2fdde54322317cbcc570242cbfd8a473786cbf571b8c8e609cc5c0614976eab293e858a227b12c651ea21127b163bbb862b6becd730643b41635fea1eb9d4eee37efbf1f2632e2555cdefd9bd14211af6b5b119bc93d3753b9fab4d969828176fd56b2f24fa1b50409e2ad129bc89ff8aa81ea1133b14f92ce8509172a0f002dfbfd0287276a065c46cde8dd56fcf97bb8905fb283be8799ed912317d850a2c8a3d4bf1f11a41de7fe514fa3e23e326cb7d3460f94e7524945072e9a14331e33055c60d47952e4c0ef1ddf8bfa2fbf47356a43c9398ce85946ee09e89b8cd8e9081bae6df7e0459d676f9f18d96b031bd2c3c7ea20b13fb3598b48229271be6c62241bda56f66ffff52dd5d454a37c35416a1d102364d8e60288ae2c51ba2d640eaba2ad871c71036b1fe95a2bbf53e24386172d01a015ecceaece4f08e0181f996627bf874965fb9b09f6633c1e72d6ca6feefdd8040a3c6d8e1e4f04d9380787e275d3a6d891d922e38212621c07315e12504bc672a43f9af4c48538a7a0ef0524c995a3a99015526ec37e491db9bcecd763bc3ee90d980915f637c51cb3627530d3d4ae705a8e18c52c7ec50d6828a7f36b17abadb43f953c8beed9425415aa704035ab97aab4f969af499e0980200cdfe0904742b1d01506c7d95a899b03883675a137b21cd633f69fad43613f59a750d527e2bffd84e9782d8a201a1e0bfa29b93a07154b530a15b7c864157f9b600561d977919090a86eb399b9625149484930fdf06efd25504a1dc87798e8da715c4dab5eb03bd2b0814955f0a4e44a5506b7063c2651d1a7a0614e4eef44b555faca40fefbe8af9cd47c915f5bdadfdb5c4ba0c2440506297e378b8eb155cd19762499b15877dd0b793d69edcefe8e2dc84e8536cba689fb310b423cf92024ca53a4038a11a222fc21c97f2c09b82ce6671e8dd9c16f37a6ea0cd7c62dc053c8ac070ef614f2273829d09d3a6f228042be37dd03d0d09] */
